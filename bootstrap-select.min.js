!function(e){var t=function(t,n,r){if(r){r.stopPropagation();r.preventDefault()}this.$element=e(t);this.$newElement=null;var i=null;this.options=e.extend({},e.fn.selectpicker.defaults,this.$element.data(),typeof n=="object"&&n);this.style=this.options.style;this.size=this.options.size;this.init()};t.prototype={constructor:t,init:function(t){this.$element.hide();var n=this.$element.attr("class")!==undefined?this.$element.attr("class").split(/\s+/):"";var r=this.getTemplate();var i=this.$element.attr("id");r=this.createLi(r);this.$element.after(r);this.$newElement=this.$element.next(".bootstrap-select");var s=this.$newElement;var o=this.$newElement.find(".dropdown-menu");var u=this.$newElement.find(".dropdown-menu ul li > a");var a=parseInt(u.css("line-height"))+u.outerHeight();var f=this.$newElement.offset().top;var l=0;var c=0;var h=this.$newElement.outerHeight();button=this.$newElement.find("> button");if(i!==undefined){button.attr("id",i);e('label[for="'+i+'"]').click(function(){s.find("button#"+i).focus()})}for(var p=0;p<n.length;p++){if(n[p]!="selectpicker"){this.$newElement.addClass(n[p])}}button.addClass(this.style);this.checkDisabled();this.clickListener();this.$element.find("optgroup").each(function(){if(e(this).attr("label")){o.find(".opt"+e(this).index()).eq(0).before("<dt>"+e(this).attr("label")+"</dt>")}o.find(".opt"+e(this).index()).eq(0).parent().prev().addClass("optgroup-div")});if(this.size=="auto"){function d(){var t=f-e(window).scrollTop();var n=window.innerHeight;var r=parseInt(o.css("padding-top"))+parseInt(o.css("padding-bottom"))+parseInt(o.css("border-top-width"))+parseInt(o.css("border-bottom-width"))+parseInt(o.css("margin-top"))+parseInt(o.css("margin-bottom"))+2;var i=n-t-h-r;if(!s.hasClass("dropup")){l=Math.floor(i/a)}else{l=Math.floor((t-r)/a)}if(l<4){l=3}c=a*l;if(o.find("ul li").length+o.find("dt").length>l){o.find("ul").css({"max-height":c+"px","overflow-y":"scroll"})}else{o.find("ul").css({"max-height":"none","overflow-y":"auto"})}}d();e(window).resize(d);e(window).scroll(d)}else if(this.size&&this.size!="auto"&&o.find("ul li").length>this.size){c=a*this.size;if(this.size==1){c=c+8}o.find("ul").css({"max-height":c+"px","overflow-y":"scroll"})}this.$newElement.find("ul").bind("DOMNodeInserted",e.proxy(this.clickListener,this))},getTemplate:function(){var e="<div class='btn-group bootstrap-select'>"+"<button class='btn dropdown-toggle clearfix' data-toggle='dropdown'>"+"<span class='filter-option pull-left'>__SELECTED_OPTION</span> "+"<span class='caret'></span>"+"</button>"+"<div class='dropdown-menu' role='menu'>"+"<ul>"+"__ADD_LI"+"</ul>"+"</div>"+"</div>";return e},createLi:function(t){var n=[];var r=[];var i="";var s=null;var o=this;var u=this.$element[0].selectedIndex?this.$element[0].selectedIndex:0;this.$element.find("option").each(function(){n.push(e(this).text())});this.$element.find("option").each(function(){if(e(this).parent().is("optgroup")){s=String(e(this).parent().index());var t=e(this).parent();for(var n=0;n<t.length;n++){r.push('<a class="opt'+s[n]+'" tabindex="-1" href="#">'+e(this).text()+"</a>")}}else{r.push('<a tabindex="-1" href="#">'+e(this).text()+"</a>")}});if(n.length>0){t=t.replace("__SELECTED_OPTION",n[u]);for(var a=0;a<n.length;a++){i+="<li rel="+a+">"+r[a]+"</li>"}}this.$element.find("option").eq(u).prop("selected",true);t=t.replace("__ADD_LI",i);return t},checkDisabled:function(){if(this.$element.is(":disabled")){button.addClass("disabled");button.click(function(e){e.preventDefault()})}},clickListener:function(){var t=this;e("body").on("touchstart.dropdown",".dropdown-menu",function(e){e.stopPropagation()});e(".dropdown-menu").find("li dt").on("click",function(e){e.stopPropagation()});this.$newElement.find("li a").on("click",function(n){n.preventDefault();var r=e(this).parent().index();var i=e(this).parent(),s=i.attr("rel"),o=i.parents(".bootstrap-select");if(t.$element.not(":disabled")){o.prev("select").find("option").eq(r).prop("selected",true);o.find(".filter-option").html(i.text());o.find("button").focus();o.prev("select").trigger("change")}});this.$element.on("change",function(t){if(e(this).find("option:selected").attr("title")!=undefined){e(this).next(".bootstrap-select").find(".filter-option").html(e(this).find("option:selected").attr("title"))}else{e(this).next(".bootstrap-select").find(".filter-option").html(e(this).find("option:selected").text())}})}};e.fn.selectpicker=function(n,r){return this.each(function(){var i=e(this),s=i.data("selectpicker"),o=typeof n=="object"&&n;if(!s){i.data("selectpicker",s=new t(this,o,r))}if(typeof n=="string"){s[n]()}})};e.fn.selectpicker.defaults={style:null,size:"auto"}}(window.jQuery)
